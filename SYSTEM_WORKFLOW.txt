================================================================================
                    TIKVAULT - QUY TRÌNH HOẠT ĐỘNG HỆ THỐNG
                         Chi tiết kỹ thuật và giải pháp
                              Version 2.1 - January 2026
================================================================================

1. TỔNG QUAN HỆ THỐNG
================================================================================

TikVault là hệ thống quản lý tri thức cá nhân (Personal Knowledge Management)
được thiết kế để:
  • Tự động hóa việc trích xuất kiến thức từ video TikTok
  • Phân loại và tổ chức nội dung theo taxonomy có cấu trúc
  • Hỗ trợ tìm kiếm ngữ nghĩa (Semantic Search)
  • Cung cấp chatbot RAG để tương tác với knowledge base

================================================================================

2. KIẾN TRÚC TỔNG THỂ
================================================================================

┌──────────────────────────────────────────────────────────────────────────────┐
│                                USER INTERFACE                                 │
│    Dashboard (/) │ Library (/library) │ Search (/search) │ Chat (/chat)      │
│                              (Jinja2 + TailwindCSS)                          │
└─────────────────────────────────────┬────────────────────────────────────────┘
                                      │ HTTP Requests
                                      ▼
┌──────────────────────────────────────────────────────────────────────────────┐
│                            FASTAPI APPLICATION                                │
│                          (app/__init__.py → create_app())                     │
│ ┌──────────────────────────────────────────────────────────────────────────┐ │
│ │                              ROUTERS                                      │ │
│ │ pages.py     │ videos.py   │ chat.py     │ collections.py │ system.py    │ │
│ │ (Frontend)   │ (/api/*)    │ (/api/chat) │ (/api/*)       │ (/api/*)     │ │
│ └──────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────┬────────────────────────────────────────┘
                                      │
              ┌───────────────────────┼───────────────────────┐
              ▼                       ▼                       ▼
┌─────────────────────┐   ┌─────────────────────┐   ┌─────────────────────────┐
│   SERVICES LAYER    │   │  DATABASE SERVICE   │   │    EXTERNAL TOOLS       │
│                     │   │  (database.py)      │   │                         │
│ ┌─────────────────┐ │   │                     │   │ ┌─────────────────────┐ │
│ │  pipeline.py    │─┼───┤ • save_video()      │   │ │ TT_Content_Scraper  │ │
│ │  (Orchestrator) │ │   │ • search_videos()   │   │ │ (Video Download)    │ │
│ └────────┬────────┘ │   │ • get_video()       │   │ └─────────────────────┘ │
│          │          │   │ • get_categories()  │   │                         │
│ ┌────────▼────────┐ │   └──────────┬──────────┘   │ ┌─────────────────────┐ │
│ │ ai_processor.py │ │              │              │ │     OpenAI API      │ │
│ │ (Transcription) │ │              │              │ │ (GPT-4o-mini LLM)   │ │
│ └────────┬────────┘ │   ┌──────────┴──────────┐   │ └─────────────────────┘ │
│          │          │   │                     │   │                         │
│ ┌────────▼────────┐ │   │    ┌────────────┐   │   │ ┌─────────────────────┐ │
│ │   analyzer.py   │─┼───┤    │  MongoDB   │   │   │ │  Google Drive API   │ │
│ │ (Knowledge Card)│ │   │    │  (Docs)    │   │   │ │ (Optional Backup)   │ │
│ └─────────────────┘ │   │    └────────────┘   │   │ └─────────────────────┘ │
│                     │   │    ┌────────────┐   │   │                         │
│ ┌─────────────────┐ │   │    │  Qdrant    │   │   └─────────────────────────┘
│ │   llm_chat.py   │─┼───┤    │ (Vectors)  │   │
│ │   (RAG Chat)    │ │   │    └────────────┘   │
│ └─────────────────┘ │   │                     │
└─────────────────────┘   └─────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                             LOCAL AI MODELS                                   │
│           local_models/bge-m3/ → BAAI/bge-m3 Embedding Model (1024 dims)     │
│           sentence-transformers → Cross-Encoder Reranker                      │
└──────────────────────────────────────────────────────────────────────────────┘

================================================================================

3. QUY TRÌNH XỬ LÝ VIDEO (Video Processing Pipeline)
================================================================================

BƯỚC 1: NHẬP VIDEO (Import)
─────────────────────────────
File: services/pipeline.py → process_tiktok()
File: services/tiktok_tool.py → download_tiktok_full_data()

Flow:
  1. User nhập URL TikTok tại Dashboard
  2. API /api/tiktok/process nhận request
  3. TT_Content_Scraper phân tích URL, extract video ID
  4. Download video/slideshow images về:
     - Video: temp/{video_id}.mp4
     - Images: scraper_data/content_files/

Output: Metadata (title, author, duration, hashtags, stats)

─────────────────────────────

BƯỚC 2: TRANSCRIPTION (Chuyển đổi giọng nói thành text)
─────────────────────────────
File: services/ai_processor.py → transcribe_video()

Flow:
  1. Đọc file video từ temp/
  2. Gửi đến API transcription
  3. Nhận về transcript text

Xử lý đặc biệt:
  - Video không có lời → transcript rỗng, dùng caption/hashtags
  - Slideshow → bỏ qua transcription

─────────────────────────────

BƯỚC 3: AI ANALYSIS (Phân tích bằng AI)
─────────────────────────────
File: services/analyzer.py → analyze_video_content()

Input: transcript + metadata (title, hashtags, duration, author)

Quy trình phân loại THÔNG MINH:

  A) BƯỚC 1 - PHÂN LOẠI CATEGORY:
     AI xác định video thuộc nhóm nào:

     NHÓM KIẾN THỨC (trích xuất CHI TIẾT):
     ┌──────────────┬────────────────────────────────────────┐
     │ ẨM_THỰC      │ Công_Thức, Review_Đánh_Giá, Quán_Ăn,   │
     │              │ Mẹo_Bếp, Ẩm_Thực_Khác                  │
     ├──────────────┼────────────────────────────────────────┤
     │ KHÁM_PHÁ     │ Du_Lịch, Địa_Điểm, Trải_Nghiệm,        │
     │              │ Văn_Hóa, Khám_Phá_Khác                 │
     ├──────────────┼────────────────────────────────────────┤
     │ PHONG_CÁCH   │ Thời_Trang, Làm_Đẹp, Decor_Nội_Thất,   │
     │              │ Lifestyle, Phong_Cách_Khác             │
     ├──────────────┼────────────────────────────────────────┤
     │ HỌC_HỎI      │ Kỹ_Năng, Ngôn_Ngữ, Công_Nghệ,          │
     │              │ Tài_Chính, Học_Hỏi_Khác                │
     ├──────────────┼────────────────────────────────────────┤
     │ ĐỜI_THƯỜNG   │ Mẹo_Vặt, Sức_Khỏe, Nuôi_Thú,           │
     │              │ Gia_Đình, Đời_Thường_Khác              │
     └──────────────┴────────────────────────────────────────┘

     NHÓM GIẢI TRÍ (chỉ SUMMARY ngắn gọn):
     ┌──────────────┬────────────────────────────────────────┐
     │ GIẢI_TRÍ     │ Hài_Hước, Âm_Nhạc, Trend_Challenge,    │
     │              │ Gaming, Giải_Trí_Khác                  │
     ├──────────────┼────────────────────────────────────────┤
     │ CẢM_XÚC      │ Motivation, Chia_Sẻ, Couple_Gia_Đình,  │
     │              │ Pets_Cute, Cảm_Xúc_Khác                │
     ├──────────────┼────────────────────────────────────────┤
     │ KHÁC         │ Chưa xác định                          │
     └──────────────┴────────────────────────────────────────┘

  B) BƯỚC 2 - TRÍCH XUẤT NỘI DUNG:

     Nếu NHÓM KIẾN THỨC:
     {
       "title": "Tiêu đề mô tả",
       "summary": "Tóm tắt 2-3 câu",
       "key_takeaways": ["Điểm 1", "Điểm 2", ...],
       "action_items": ["Bước 1", "Bước 2", ...],
       "entities": {
         "ingredients": ["thịt bò 500g", "hành tây 2 củ"],
         "products": ["MAC Ruby Woo", "iPhone 15"],
         "locations": ["Phở Thìn - 13 Lò Đúc, Hà Nội"]
       },
       "tags": ["tag1", "tag2", ...]
     }

     Nếu NHÓM GIẢI TRÍ:
     {
       "title": "Tiêu đề mô tả",
       "summary": "Tóm tắt ngắn gọn 1-2 câu",
       "tags": ["tag1", "tag2", ...]
     }

  C) QUY TẮC PHÂN LOẠI ĐẶC BIỆT:

     | Nội dung                        | Phân loại đúng      |
     |─────────────────────────────────|─────────────────────|
     | Makeup tutorial (hướng dẫn)     | PHONG_CÁCH > Làm_Đẹp|
     | Makeup haul (khoe đồ)           | PHONG_CÁCH > Làm_Đẹp|
     | Video hài, react, prank         | GIẢI_TRÍ > Hài_Hước |
     | Vlog đời thường vui vẻ          | GIẢI_TRÍ            |
     | Mẹo tiết kiệm, tài chính        | HỌC_HỎI > Tài_Chính |
     | Review quán ăn                  | ẨM_THỰC > Review    |
     | Du lịch có thông tin            | KHÁM_PHÁ > Du_Lịch  |

─────────────────────────────

BƯỚC 4: EMBEDDING & INDEXING
─────────────────────────────
File: services/database.py → _save_video_embeddings()

Flow:
  1. Lấy Knowledge Card text
  2. Embed với BAAI/bge-m3 (1024 dimensions, local model)
  3. Upsert vào Qdrant collection: video_chunks_bge_m3

Payload trong Qdrant:
  {
    "video_id": "123456",
    "title": "...",
    "category": "ẨM_THỰC",
    "subcategory": "Công_Thức",
    "chunk_text": "..."
  }

─────────────────────────────

BƯỚC 5: LƯU DATABASE
─────────────────────────────
File: services/database.py → save_video()

MongoDB document structure:
  {
    "video_id": "123456789",
    "title": "Cách nấu phở bò",
    "author": {"nickname": "...", "id": "..."},
    "transcript": "...",
    "hashtags": ["#pho", "#nauanuon"],
    "stats": {"views": 100000, "likes": 5000},
    "ai_analysis": {
      "classification": {
        "level_1": "ẨM_THỰC",
        "level_2": "Công_Thức",
        "category_path": "ẨM_THỰC > Công_Thức"
      },
      "knowledge_card": {...}
    },
    "processed_at": ISODate("...")
  }

================================================================================

4. QUY TRÌNH TÌM KIẾM (Search Pipeline)
================================================================================

File: services/database.py → search_videos()
File: services/llm_chat.py → generate_rag_answer()

BƯỚC 1: QUERY EXPANSION
─────────────────────────────
  Input: "cách làm phở"
  Output: ["phở bò", "nấu phở", "công thức phở", "hướng dẫn phở"]

BƯỚC 2: VECTOR SEARCH (Qdrant)
─────────────────────────────
  1. Embed query với BGE-M3
  2. Search top-K nearest vectors
  3. Score = cosine similarity

BƯỚC 3: RERANKING (Cross-Encoder)
─────────────────────────────
  1. Score lại từng (query, document) pair
  2. Reorder theo relevance score mới
  3. Filter bằng threshold (mặc định 45%)

BƯỚC 4: MONGODB LOOKUP
─────────────────────────────
  1. Lấy video_ids từ Qdrant results
  2. Query MongoDB để lấy full metadata
  3. Return videos với Knowledge Cards đầy đủ

================================================================================

5. QUY TRÌNH CHAT RAG
================================================================================

File: services/llm_chat.py → generate_chat_answer()

BƯỚC 1: CONTEXT RETRIEVAL
─────────────────────────────
  • Nhận user query + conversation history
  • Chạy Search Pipeline để lấy relevant videos
  • Extract Knowledge Cards của các videos

BƯỚC 2: PROMPT CONSTRUCTION
─────────────────────────────
  System Prompt:
    - Role: "TikVault Knowledge Expert"
    - Chỉ được dùng thông tin từ context
    - Cite nguồn [Video X]
    - Trả lời bằng tiếng Việt

  User Prompt:
    - Chèn Knowledge Cards vào context
    - Thêm conversation history (6 messages gần nhất)
    - Append user query

BƯỚC 3: GENERATE RESPONSE
─────────────────────────────
  • Gọi OpenAI GPT-4o-mini
  • Parse response
  • Return với sources (video references)

================================================================================

6. MULTI-SELECT FEATURES (Library)
================================================================================

File: templates/library.html

Chức năng:
  • Chọn tối đa 5 videos trong Library
  • Nút "Copy": Copy nội dung chi tiết vào clipboard
  • Nút "Chat": Chuyển sang Chat với content đã copy

Flow Copy:
  1. User chọn videos (checkbox)
  2. Click "Copy"
  3. Fetch /video/{id} với Accept: application/json
  4. Format content: Title, Summary, Key Takeaways, Action Items
  5. Copy vào clipboard

Flow Chat:
  1. User chọn videos
  2. Click "Chat"
  3. Redirect to /chat?selected=id1,id2,id3
  4. Chat page tự động copy content và hiển thị banner

================================================================================

7. DATA FLOW DIAGRAM
================================================================================

7.1. VIDEO IMPORT FLOW
───────────────────────────────────────────────────────────────────────────────

                                 ┌─────────────┐
                                 │    USER     │
                                 │ (Dashboard) │
                                 └──────┬──────┘
                                        │ 1. Submit TikTok URL
                                        ▼
                              ┌───────────────────┐
                              │  POST /api/tiktok │
                              │     /process      │
                              └─────────┬─────────┘
                                        │ 2. Call pipeline
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────┐
│                          PIPELINE (services/pipeline.py)                       │
│                                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 1: DOWNLOAD                                                        │  │
│  │ ┌─────────────────────┐     ┌──────────────────────────────────────┐   │  │
│  │ │ tiktok_tool.py      │────►│ TT_Content_Scraper                   │   │  │
│  │ │ download_tiktok_    │     │ • Parse URL → Extract video_id       │   │  │
│  │ │ full_data()         │     │ • Download video → temp/{id}.mp4     │   │  │
│  │ └─────────────────────┘     │ • Slideshow → scraper_data/images/   │   │  │
│  │                             │ • Return metadata (author, hashtags) │   │  │
│  │                             └──────────────────────────────────────┘   │  │
│  └───────────────────────────────────────┬─────────────────────────────────┘  │
│                                          │ video + metadata                   │
│                                          ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 2: TRANSCRIPTION                                                   │  │
│  │ ┌─────────────────────┐     ┌──────────────────────────────────────┐   │  │
│  │ │ ai_processor.py     │────►│ OpenAI Whisper API / Local STT       │   │  │
│  │ │ transcribe_video()  │     │ • Audio extraction from video        │   │  │
│  │ └─────────────────────┘     │ • Speech-to-Text processing          │   │  │
│  │                             │ • Return transcript text              │   │  │
│  │                             └──────────────────────────────────────┘   │  │
│  └───────────────────────────────────────┬─────────────────────────────────┘  │
│                                          │ transcript                         │
│                                          ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 3: AI ANALYSIS                                                     │  │
│  │ ┌─────────────────────┐     ┌──────────────────────────────────────┐   │  │
│  │ │ analyzer.py         │────►│ OpenAI GPT-4o-mini                   │   │  │
│  │ │ analyze_video_      │     │                                      │   │  │
│  │ │ content()           │     │ Input: transcript + metadata         │   │  │
│  │ └─────────────────────┘     │                                      │   │  │
│  │                             │ Process:                             │   │  │
│  │                             │ • Classify category (8 root + subs)  │   │  │
│  │                             │ • Extract knowledge (Heavy/Lite)     │   │  │
│  │                             │                                      │   │  │
│  │                             │ Output: Knowledge Card JSON          │   │  │
│  │                             │ {classification, title, summary,     │   │  │
│  │                             │  key_takeaways, action_items,        │   │  │
│  │                             │  entities, tags}                     │   │  │
│  │                             └──────────────────────────────────────┘   │  │
│  └───────────────────────────────────────┬─────────────────────────────────┘  │
│                                          │ ai_analysis                        │
│                                          ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 4: SAVE TO DATABASE                                                │  │
│  │ ┌─────────────────────┐                                                 │  │
│  │ │ database.py         │                                                 │  │
│  │ │ save_video()        │                                                 │  │
│  │ └─────────┬───────────┘                                                 │  │
│  │           │                                                             │  │
│  │           ├────────────────────────────┬────────────────────────────┐   │  │
│  │           ▼                            ▼                            │   │  │
│  │   ┌─────────────────┐          ┌─────────────────┐                  │   │  │
│  │   │ MongoDB         │          │ Qdrant          │                  │   │  │
│  │   │                 │          │                 │                  │   │  │
│  │   │ Collection:     │          │ _save_video_    │                  │   │  │
│  │   │ videos          │          │ embeddings()    │                  │   │  │
│  │   │                 │          │                 │                  │   │  │
│  │   │ Document:       │          │ • Embed summary │                  │   │  │
│  │   │ {video_id,      │          │   + takeaways   │                  │   │  │
│  │   │  title, author, │          │   with BGE-M3   │                  │   │  │
│  │   │  transcript,    │          │ • Store vector  │                  │   │  │
│  │   │  hashtags,      │          │   1024 dims     │                  │   │  │
│  │   │  stats,         │          │ • Payload:      │                  │   │  │
│  │   │  ai_analysis}   │          │   video_id,     │                  │   │  │
│  │   │                 │          │   category      │                  │   │  │
│  │   └─────────────────┘          └─────────────────┘                  │   │  │
│  └─────────────────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
                              ┌───────────────────┐
                              │  Return Result    │
                              │  (video_info, OK) │
                              └───────────────────┘


7.2. SEARCH & RAG CHAT FLOW
───────────────────────────────────────────────────────────────────────────────

                                 ┌─────────────┐
                                 │    USER     │
                                 │(Search/Chat)│
                                 └──────┬──────┘
                                        │ 1. Search/Chat query
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────┐
│                         SEARCH (database.py → search_videos())                 │
│                                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 1: QUERY EXPANSION (llm_chat.py → expand_query())                  │  │
│  │                                                                         │  │
│  │ Input:  "cách làm phở"                                                  │  │
│  │ Output: ["phở bò", "nấu phở", "công thức phở", "hướng dẫn phở"]         │  │
│  └───────────────────────────────────────┬─────────────────────────────────┘  │
│                                          ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 2: VECTOR SEARCH (Qdrant)                                          │  │
│  │                                                                         │  │
│  │ ┌─────────────────────┐     ┌──────────────────────────────────────┐   │  │
│  │ │ get_embedding()     │────►│ BGE-M3 Local Model                   │   │  │
│  │ │ (Embed query)       │     │ • Convert query → 1024-dim vector    │   │  │
│  │ └─────────────────────┘     └──────────────────────────────────────┘   │  │
│  │                                          │                             │  │
│  │                                          ▼                             │  │
│  │                             ┌──────────────────────────────────────┐   │  │
│  │                             │ Qdrant.search()                      │   │  │
│  │                             │ • Cosine similarity search           │   │  │
│  │                             │ • Return top-K nearest vectors       │   │  │
│  │                             │ • Get video_ids + scores             │   │  │
│  │                             └──────────────────────────────────────┘   │  │
│  └───────────────────────────────────────┬─────────────────────────────────┘  │
│                                          ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 3: RERANKING (Cross-Encoder)                                       │  │
│  │                                                                         │  │
│  │ ┌─────────────────────────────────────────────────────────────────────┐ │  │
│  │ │ For each (query, document) pair:                                    │ │  │
│  │ │ • Cross-Encoder score calculation                                   │ │  │
│  │ │ • Reorder by relevance score                                        │ │  │
│  │ │ • Filter threshold: score >= 45%                                    │ │  │
│  │ └─────────────────────────────────────────────────────────────────────┘ │  │
│  └───────────────────────────────────────┬─────────────────────────────────┘  │
│                                          ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │ STEP 4: MONGODB LOOKUP                                                  │  │
│  │                                                                         │  │
│  │ ┌─────────────────────────────────────────────────────────────────────┐ │  │
│  │ │ videos.find({video_id: {$in: [id1, id2, ...]}})                     │ │  │
│  │ │ • Fetch full metadata for each video_id                             │ │  │
│  │ │ • Return complete Knowledge Cards                                   │ │  │
│  │ └─────────────────────────────────────────────────────────────────────┘ │  │
│  └───────────────────────────────────────┬─────────────────────────────────┘  │
└──────────────────────────────────────────┼────────────────────────────────────┘
                                           │
          ┌────────────────────────────────┴────────────────────────────────┐
          │                                                                 │
          ▼ [Search Page]                                                   ▼ [Chat Page]
┌─────────────────────────┐                             ┌──────────────────────────────────┐
│ Display Results         │                             │ RAG CHAT (llm_chat.py)           │
│ • Video cards           │                             │                                  │
│ • Knowledge previews    │                             │ ┌──────────────────────────────┐ │
│ • Relevance scores      │                             │ │ generate_rag_answer()        │ │
└─────────────────────────┘                             │ │                              │ │
                                                        │ │ 1. Build context from        │ │
                                                        │ │    Knowledge Cards           │ │
                                                        │ │                              │ │
                                                        │ │ 2. Construct prompt:         │ │
                                                        │ │    System: TikVault Expert   │ │
                                                        │ │    Context: Knowledge Cards  │ │
                                                        │ │    History: 6 recent msgs    │ │
                                                        │ │    Query: user question      │ │
                                                        │ │                              │ │
                                                        │ │ 3. Call GPT-4o-mini          │ │
                                                        │ │                              │ │
                                                        │ │ 4. Return answer + sources   │ │
                                                        │ └──────────────────────────────┘ │
                                                        └──────────────────────────────────┘
                                                                         │
                                                                         ▼
                                                        ┌──────────────────────────────────┐
                                                        │ Display Answer                   │
                                                        │ • Formatted response             │
                                                        │ • Source citations [Video X]    │
                                                        │ • Related videos                 │
                                                        └──────────────────────────────────┘

================================================================================

8. CÔNG NGHỆ SỬ DỤNG
================================================================================

Backend Framework:     FastAPI (async, modern Python)
Template Engine:       Jinja2
Document Database:     MongoDB (videos, users, collections)
Vector Database:       Qdrant (embeddings, semantic search)
LLM Provider:          OpenAI GPT-4o-mini
Embedding Model:       BAAI/bge-m3 (local, 1024 dims)
Reranker:              Cross-Encoder (sentence-transformers)
Video Scraping:        Custom TT_Content_Scraper
Frontend:              HTML + TailwindCSS + Vanilla JS

================================================================================

9. THƯ MỤC QUAN TRỌNG
================================================================================

e:\TikVault\
├── app\                   # FastAPI application
│   ├── __init__.py       # App factory
│   ├── dependencies.py   # Shared dependencies (templates, db)
│   └── routers\          # API + Page routes
│       ├── pages.py      # Frontend: /, /library, /search, /video, /chat
│       ├── auth.py       # Auth pages: /auth/login, /auth/signup
│       ├── videos.py     # Video APIs: /api/tiktok/process, etc.
│       ├── chat.py       # Chat RAG API: /api/chat
│       └── collections.py # Collections API
│
├── services\              # Business logic
│   ├── analyzer.py       # AI Knowledge Card (NHÓM KIẾN THỨC vs GIẢI TRÍ)
│   ├── llm_chat.py       # RAG Answer generation
│   ├── database.py       # MongoDB + Qdrant operations
│   ├── pipeline.py       # Video processing pipeline
│   └── tiktok_tool.py    # TikTok scraper integration
│
├── templates\             # Jinja2 HTML templates
│   ├── dashboard.html    # Home page với video grid + import
│   ├── library.html      # Library with category filters + multi-select
│   ├── search.html       # AI-powered search
│   ├── video_detail.html # Video detail + Knowledge Card
│   └── chat.html         # Chat với AI assistant
│
├── local_models\          # Local AI models
│   └── bge-m3\           # BAAI/bge-m3 embedding model
│
└── TT_Content_Scraper\    # TikTok scraping engine

================================================================================

10. TROUBLESHOOTING
================================================================================

VẤN ĐỀ 1: Video phân loại sai category
─────────────────────────────
  → Kiểm tra hashtags và captions
  → AI ưu tiên hashtags khi phân loại
  → Có thể re-analyze: POST /api/video/{id}/reanalyze

VẤN ĐỀ 2: Search không tìm thấy kết quả
─────────────────────────────
  → Kiểm tra Qdrant đang chạy (localhost:6333)
  → Kiểm tra video đã được embedding chưa
  → Thử query khác với từ khóa cụ thể hơn

VẤN ĐỀ 3: Chat không trả lời đúng
─────────────────────────────
  → Kiểm tra có video liên quan trong database không
  → Chat chỉ trả lời dựa trên videos đã import
  → Import thêm videos về chủ đề đó

VẤN ĐỀ 4: Copy không hoạt động
─────────────────────────────
  → Kiểm tra browser cho phép clipboard access
  → Mở DevTools (F12) xem console logs
  → Video endpoint có trả về JSON không

================================================================================
                                  END OF DOCUMENT
================================================================================
